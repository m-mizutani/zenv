# Test advanced features with profiles

[SSL_CERT]
file = "testdata/config_content.txt"
[SSL_CERT.profile.dev]
value = "-----BEGIN CERTIFICATE-----\ndev-cert-content\n-----END CERTIFICATE-----"
[SSL_CERT.profile.prod]
file = "testdata/config_content.txt"

[HOSTNAME]
command = "echo"
args = ["default-host"]
[HOSTNAME.profile.dev]
value = "dev-server"
[HOSTNAME.profile.staging]
command = "echo"
args = ["staging-server"]
[HOSTNAME.profile.prod]
command = "echo"
args = ["prod-server"]

[API_KEY]
alias = "PRIMARY_DB"
[API_KEY.profile.dev]
value = "dev-api-key-12345"
[API_KEY.profile.prod]
alias = "SECONDARY_DB"

# Referenced by API_KEY alias
[PRIMARY_DB]
value = "postgres://localhost/primary"

[SECONDARY_DB]
value = "postgres://localhost/secondary"

[CONFIG_PATH]
template = "/etc/{{.ENV}}/config.yml"
refs = ["ENV"]
[CONFIG_PATH.profile.dev]
value = "/home/dev/config.yml"
[CONFIG_PATH.profile.prod]
template = "/opt/{{.ENV}}/{{.APP}}/config.yml"
refs = ["ENV", "APP"]

[ENV]
value = "default"

[APP]
value = "myapp"